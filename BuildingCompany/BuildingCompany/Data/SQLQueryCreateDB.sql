CREATE DATABASE BuildingCompany;

USE BuildingCompany;

CREATE TABLE Profession
(
ID INT PRIMARY KEY IDENTITY,
Name NVARCHAR(100) NOT NULL
);

CREATE TABLE Worker
(
ID INT PRIMARY KEY IDENTITY,
FIO NVARCHAR(100) NOT NULL,
PhoneNumber VARCHAR(11) NOT NULL UNIQUE,
Comment NVARCHAR(300)
);

CREATE TABLE Brigade
(
ID INT PRIMARY KEY IDENTITY,
Name NVARCHAR(100) NOT NULL UNIQUE,
Brigadier INT REFERENCES Worker(ID) NOT NULL,
Comment NVARCHAR(300)
);

CREATE TABLE ProfessionWorker
(
ID INT PRIMARY KEY IDENTITY,
WorkerID INT REFERENCES Worker(ID) ON DELETE CASCADE NOT NULL,
ProfessionID INT REFERENCES Profession(ID) ON DELETE CASCADE NOT NULL
);

CREATE TABLE MembershipBrigade
(
ID INT PRIMARY KEY IDENTITY,
BrigadeID INT REFERENCES Brigade(ID) ON DELETE CASCADE NOT NULL,
WorkerID INT REFERENCES Worker(ID) ON DELETE CASCADE NOT NULL
);

CREATE TABLE TypeOfFacility
(
ID INT PRIMARY KEY IDENTITY,
Name NVARCHAR(100) NOT NULL UNIQUE
);

CREATE TABLE Facility
(
ID INT PRIMARY KEY IDENTITY,
Name NVARCHAR(150) NOT NULL,
Address NVARCHAR(100) NOT NULL,
TypeOfFacilityID INT REFERENCES TypeOfFacility(ID) ON DELETE CASCADE NOT NULL
);

CREATE TABLE Schedule
(
ID INT PRIMARY KEY IDENTITY,
FacilityID INT REFERENCES Facility(ID) NOT NULL,
WorkDescription NVARCHAR(500) NOT NULL,
BrigadeID INT REFERENCES Brigade(ID) ON DELETE CASCADE NOT NULL,
Comment NVARCHAR(300),
EndingDate DATE NOT NULL
);

CREATE TABLE Material
(
ID INT PRIMARY KEY IDENTITY,
Name NVARCHAR(100) NOT NULL UNIQUE,
UnitOfMeasure NVARCHAR(50) NOT NULL
);

CREATE TABLE UseOfMaterial
(
ID INT PRIMARY KEY IDENTITY,
FacilityID INT REFERENCES Facility(ID) NOT NULL,
BrigadeID INT REFERENCES Brigade(ID) ON DELETE CASCADE NOT NULL,
MaterialID INT REFERENCES Material(ID) ON DELETE CASCADE NOT NULL,
Amount INT NOT NULL
);

